<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FERMI-GLAST TRACKER PROJECT: CMEPDA-GLAST/Core/TrackingRetina/RectifyTracks.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FERMI-GLAST TRACKER PROJECT
   </div>
   <div id="projectbrief">L&#39;obiettivo di questo progetto Ã¨ la misura della distribuzione angolare zenith ad azimuth dei raggi cosmici a partire dai dati ottenuti da 10 layer del tracker Fermi-GLast</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_0d7e5adfc904a6a8d9d4631aa268d26d.html">CMEPDA-GLAST</a></li><li class="navelem"><a class="el" href="../../dir_1a05c4abcf6d810326156485d47a50ae.html">Core</a></li><li class="navelem"><a class="el" href="../../dir_2fb8f0199ae5bef9b2cba70d296e4502.html">TrackingRetina</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">RectifyTracks.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d2/db4/RectifyTracks_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include&lt;sstream&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include&lt;map&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include&quot;<a class="code" href="../../dc/d78/GeneralUtils_8h.html">GeneralUtils.h</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include&quot;<a class="code" href="../../d6/d0d/UtilsRectifyTracks_8h.html">UtilsRectifyTracks.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="keywordtype">void</span> RectifyTracks(TString file, TString fileoutput){</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    <span class="comment">//                                                                  SECTION 1: CREATE UTILS VARIABLE, TREES TO BE READ AND FILLED, </span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    <span class="comment">// CREATE TREE TO BE READ </span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    <a class="code hl_class" href="../../d2/da4/classEventoTrack.html">EventoTrack</a> e; </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <a class="code hl_class" href="../../d2/da4/classEventoTrack.html">EventoTrack</a> *p = &amp;e;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    TFile *input = <span class="keyword">new</span> TFile(file,<span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    TTree *tree = (TTree*)input-&gt;Get(<span class="stringliteral">&quot;treetrack&quot;</span>);</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;etrack&quot;</span>, &amp;p); </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    <span class="keywordtype">int</span> entries = tree-&gt;GetEntries();</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <span class="comment">// CREATE TREE TO BE WRITTEN</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <a class="code hl_class" href="../../d2/da4/classEventoTrack.html">EventoTrack</a> etrack;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    TFile *output = <span class="keyword">new</span> TFile(fileoutput,<span class="stringliteral">&quot;recreate&quot;</span>);</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    TTree *treetrackoutput = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;treetrack&quot;</span>, <span class="stringliteral">&quot;treetrack&quot;</span>);</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    treetrackoutput-&gt;Branch(<span class="stringliteral">&quot;etrack&quot;</span>,&amp;etrack);</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <span class="comment">// CREATE UTILS VARIABLES AND PLACEHOLDERS</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    <span class="comment">//simply create the fit functions for a track</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    TF1 *lineX = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;lineX&quot;</span>, <span class="stringliteral">&quot;[0] + [1]*x&quot;</span>, -2, 50); </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    TF1 *lineY = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;lineY&quot;</span>, <span class="stringliteral">&quot;[0] + [1]*x&quot;</span>, -2, 50);</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    <span class="keywordtype">int</span> n;  <span class="comment">//variable used to fill the TGraphErrors.</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="keywordtype">double</span> mx, qx, my, qy, chi2X, chi2Y,chi2AttX,chi2AttY; <span class="comment">//placeholders variables for fitting.</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    std::vector&lt;size_t&gt; TracksXToBeErased; <span class="comment">//container of the index of the tracks in the container TrackX of the object EventoTrack that do not pass the cut in chisquare on the XZ vision, those are to be removed from the object EventoTrack.</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    std::vector&lt;size_t&gt; TracksYToBeErased; <span class="comment">//container of the index of the tracks in the container TrackY of the object EventoTrack that do not pass the cut in chisquare on the YZ vision, those are to be removed from the object EventoTrack.</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    TH1F *chi2XHist = <span class="keyword">new</span> TH1F(<span class="stringliteral">&quot;hist&quot;</span>, <span class="stringliteral">&quot;Chisquare distribution 3 dof, after correcting systematics&quot;</span>, 2000,0 ,50);</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    TH1F *oldchi2XHist = <span class="keyword">new</span> TH1F(<span class="stringliteral">&quot;hist&quot;</span>, <span class="stringliteral">&quot;Chisquare distribution 3 dof, before correcting systematics&quot;</span>, 2000,0 ,50);</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keyword">auto</span> start = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i =0; i&lt;entries; i++){</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        tree-&gt;GetEntry(i);</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        TracksXToBeErased.clear(); <span class="comment">//reset utils variable</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>        TracksYToBeErased.clear(); <span class="comment">//reset utils variable </span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        <span class="comment">//                                                              SECTION 2: WORK WITH EVENTS THAT HAVE ONLY 1 PROJECTION FOR EACH VISION</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>        <span class="comment">//In this section we work with event that have 1 potential track for each vision, correction for shifts along XYZ and for relative rotations are made, </span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>        <span class="comment">//a fit is the made with the corrected data and a cut in chisquare is made at 95% of the integral of the NOMINAL CHISQUARE DISTRIBUTION for the corresponding dof. </span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <span class="keywordflow">if</span>((e.<a class="code hl_function" href="../../d2/da4/classEventoTrack.html#a5cb6f67c0416adee2f3dee2039944d27">Nx</a>()==1) &amp;&amp; (e.<a class="code hl_function" href="../../d2/da4/classEventoTrack.html#a88ac7f432f68018e471bb50b73b36d36">Ny</a>()==1)){</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>            <span class="comment">//copy object from the read tree to the object on the tree to be written</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>            </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            etrack = e;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>            <span class="comment">//container of points where to make lineare fit</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>            TGraphErrors *XZ = <span class="keyword">new</span> TGraphErrors();</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            TGraphErrors *YZ = <span class="keyword">new</span> TGraphErrors();</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>            </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>            <span class="comment">//setup variables for finding the fit </span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            mx = e.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[1]; </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>            my = e.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Fit[1];</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>            qx = e.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[0];</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>            qy = e.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Fit[0];</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            <span class="keywordflow">if</span>(etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[3] == 3){</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                oldchi2XHist-&gt;Fill(etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[2]);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>            }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>            </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>            <span class="comment">//correct the projection on the XZ vision for relative shifts and relative angle between layers</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj = 0; jj&lt;etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].ClusterPosition.size(); jj++){</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>                n = XZ-&gt;GetN();</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].ClusterPosition[jj] += -<a class="code hl_function" href="../../d4/df5/UtilsRectifyTracks_8cpp.html#a84e55be38b776611ae78cd78e781086b">AngleCorrection</a>(etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Layer[jj], mx,qx,my,qy) - MapShift[etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Layer[jj]];</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Error[jj] = ErrorXYAngoloZ[etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Layer[jj]]; </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                XZ-&gt;SetPoint(n, <a class="code hl_function" href="../../dc/d43/GeneralUtils_8cpp.html#a2d662b9f40450252cd0a030691fc914f">LayerCoordinate</a>(etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Layer[jj]), etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].ClusterPosition[jj] );</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>                XZ-&gt;SetPointError(n, 0, etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Error[jj]);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            }</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>            <span class="comment">//correct the projection on the YZ vision for relative shifts and relative angle between layers</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj = 0; jj&lt;etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].ClusterPosition.size(); jj++){</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                n = YZ-&gt;GetN();</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].ClusterPosition[jj] += -<a class="code hl_function" href="../../d4/df5/UtilsRectifyTracks_8cpp.html#a84e55be38b776611ae78cd78e781086b">AngleCorrection</a>(etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Layer[jj], mx,qx,my,qy) - MapShift[etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Layer[jj]];</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Error[jj] = ErrorXYAngoloZ[etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Layer[jj]]; </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                YZ-&gt;SetPoint(n, <a class="code hl_function" href="../../dc/d43/GeneralUtils_8cpp.html#a2d662b9f40450252cd0a030691fc914f">LayerCoordinate</a>(etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Layer[jj]), etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].ClusterPosition[jj]);</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                YZ-&gt;SetPointError(n, 0,etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Error[jj]);</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>            }</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>            <span class="comment">//simply do the linear fit for each vision.</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>            lineX-&gt;SetParameter(0,qx);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            lineX-&gt;SetParameter(1,mx);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>            </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>            XZ-&gt;Fit(<span class="stringliteral">&quot;lineX&quot;</span>,<span class="stringliteral">&quot;qEX0&quot;</span>);</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            mx = lineX-&gt;GetParameter(1);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>            qx =lineX-&gt;GetParameter(0);</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>            chi2X =lineX-&gt;GetChisquare();</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>            chi2AttX =XZ-&gt;GetN()-2;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>            </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>            lineY-&gt;SetParameter(0,qy);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>            lineY-&gt;SetParameter(1,my);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>            YZ-&gt;Fit(<span class="stringliteral">&quot;lineY&quot;</span>,<span class="stringliteral">&quot;qEX0&quot;</span>);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            my = lineY-&gt;GetParameter(1);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>            qy =lineY-&gt;GetParameter(0);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>            chi2Y =lineY-&gt;GetChisquare();</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>            chi2AttY = YZ-&gt;GetN() - 2;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>            </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>            </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>            <span class="keywordflow">if</span>(chi2AttX ==3){ </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                chi2XHist-&gt;Fill(chi2X);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>            }</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>            </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>            <span class="comment">//if the track passes the cut, fill the object with the info on the track, else remove the track</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>            <span class="keywordflow">if</span>((chi2X&lt;SoglieChiMappa[chi2AttX])){</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>            </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[0]= qx;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[1]= mx;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[2]= chi2X;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[3]= chi2AttX;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>[0].Fit[4]= chi2X/chi2AttX;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>            }</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>.pop_back();</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            }</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            <span class="comment">//if the track passes the cut, fill the object with the info on the track, else remove the track</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>            <span class="keywordflow">if</span>((chi2Y&lt;SoglieChiMappa[chi2AttY])){</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Fit[0]= qy;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Fit[1]= my;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Fit[2]= chi2Y;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Fit[3]= chi2AttY;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>[0].Fit[4]= chi2Y/chi2AttY;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>            }</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>.pop_back();</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>            }</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>            <span class="keyword">delete</span> XZ; <span class="comment">//delete containers for points</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>            <span class="keyword">delete</span> YZ; <span class="comment">//delete containers for points</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        }</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span> </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>        <span class="comment">//                                                              SECTION 3: WORK WITH EVENTS THAT DO NOT HAVE ONLY 1 PROJECTION FOR AT LEAST A VISION</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <span class="comment">//In this section we work with event that do not have 1 potential track for at least one vision, correction for shifts along XYZ is made, </span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        <span class="comment">//a fit is the made with the corrected data and a cut in chisquare is made at 95% of the integral of the NOMINAL CHISQUARE DISTRIBUTION for the corresponding dof. </span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        {</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>            etrack = e; <span class="comment">//copy object from the read tree to the object on the tree to be written</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>            <span class="keywordtype">size_t</span> mm = 0; <span class="comment">//util variable, placeholder for the index of the tracks that do not pass the chisquare cuts.</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>            <span class="comment">//corrects each projection with shifts on XZ, angle correction is not made as there are ambiguities in the reconstruction.</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> track:etrack.TrackX){</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>                TGraphErrors *XZ = <span class="keyword">new</span> TGraphErrors();</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>                <span class="comment">//correct shifts </span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj = 0; jj&lt;track.ClusterPosition.size(); jj++){</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                    track.ClusterPosition[jj] += - MapShift[track.Layer[jj]]; </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>                    track.Error[jj] = ErrorXYZ[track.Layer[jj]]; </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>                    XZ-&gt;SetPoint(n, <a class="code hl_function" href="../../dc/d43/GeneralUtils_8cpp.html#a2d662b9f40450252cd0a030691fc914f">LayerCoordinate</a>(track.Layer[jj]), track.ClusterPosition[jj] );</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                    XZ-&gt;SetPointError(n, 0, track.Error[jj]);</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>                }</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>                <span class="comment">//simply do fit</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                lineX-&gt;SetParameter(0,qx);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>                lineX-&gt;SetParameter(1,mx);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>                XZ-&gt;Fit(<span class="stringliteral">&quot;lineX&quot;</span>,<span class="stringliteral">&quot;qEX0&quot;</span>);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>                mx = lineX-&gt;GetParameter(1);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>                qx =lineX-&gt;GetParameter(0);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>                chi2X =lineX-&gt;GetChisquare();</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>                chi2AttX =XZ-&gt;GetN()-2;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>                <span class="comment">//if cut is passed, than fill object with new fit values, else put index of tracks on the container of indexes of tracks to be erased.</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>                <span class="keywordflow">if</span>((chi2X&lt;SoglieChiMappa[chi2AttX])){</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>                </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>                    track.Fit[0]= qx;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                    track.Fit[1]= mx;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>                    track.Fit[2]= chi2X;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>                    track.Fit[3]= chi2AttX;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>                    track.Fit[4]= chi2X/chi2AttX;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                }</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>                    TracksXToBeErased.push_back(mm);</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>                }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                mm++;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                <span class="keyword">delete</span> XZ;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>            }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>            mm =0; <span class="comment">//reset utils</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            <span class="comment">//corrects each projection with shifts on YZ, angle correction is not made as there are ambiguities in the reconstruction.</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> track:etrack.TrackY){</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>                TGraphErrors *YZ = <span class="keyword">new</span> TGraphErrors();</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                <span class="comment">//correct shifts </span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj = 0; jj&lt;track.ClusterPosition.size(); jj++){</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>                    track.ClusterPosition[jj] += - MapShift[track.Layer[jj]]; </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>                    track.Error[jj] = ErrorXYZ[track.Layer[jj]]; </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                    YZ-&gt;SetPoint(n, <a class="code hl_function" href="../../dc/d43/GeneralUtils_8cpp.html#a2d662b9f40450252cd0a030691fc914f">LayerCoordinate</a>(track.Layer[jj]), track.ClusterPosition[jj] );</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>                    YZ-&gt;SetPointError(n, 0, track.Error[jj]);</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>                }</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>                <span class="comment">//simply do fit</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>                lineY-&gt;SetParameter(0,qy);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>                lineY-&gt;SetParameter(1,my);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>                YZ-&gt;Fit(<span class="stringliteral">&quot;lineX&quot;</span>,<span class="stringliteral">&quot;qEX0&quot;</span>);</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>                my = lineY-&gt;GetParameter(1);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>                qy =lineY-&gt;GetParameter(0);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>                chi2Y =lineY-&gt;GetChisquare();</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                chi2AttY =YZ-&gt;GetN()-2;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                <span class="comment">//if cut is passed, than fill object with new fit values, else put index of tracks on the container of indexes of tracks to be erased.</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>                <span class="keywordflow">if</span>((chi2Y&lt;SoglieChiMappa[chi2AttY])){</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>                    track.Fit[0]= qy;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                    track.Fit[1]= my;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>                    track.Fit[2]= chi2Y;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>                    track.Fit[3]= chi2AttY;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>                    track.Fit[4]= chi2Y/chi2AttY;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>                }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>                <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>                    TracksYToBeErased.push_back(mm);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>                }</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>                mm++;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>                <span class="keyword">delete</span> YZ;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>                </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            }</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            <span class="comment">//erase tracks that do not pass the chisquare cut on the XZ vision</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = TracksXToBeErased.rbegin(); it !=TracksXToBeErased.rend();++it){</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>.erase(etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">TrackX</a>.begin() + *it);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            }</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>            <span class="comment">//erase tracks that do not pass the chisquare cut on the YZ vision</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = TracksYToBeErased.rbegin(); it !=TracksYToBeErased.rend(); ++it){</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>                etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>.erase(etrack.<a class="code hl_variable" href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">TrackY</a>.begin() + *it);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>            }</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>        treetrackoutput-&gt;Fill();</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    }</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    oldchi2XHist-&gt;SaveAs(<span class="stringliteral">&quot;Data/Dataroot/TrackingAbstractionData/oldchi2Dist.root&quot;</span>);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    chi2XHist-&gt;SaveAs(<span class="stringliteral">&quot;Data/Dataroot/TrackingAbstractionData/chi2Dist.root&quot;</span>);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="comment">/*TCanvas *c1 = new TCanvas();</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span><span class="comment">    oldchi2XHist-&gt;Draw();</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span><span class="comment"></span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span><span class="comment">    TCanvas *c2 = new TCanvas();</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span><span class="comment">    chi2XHist-&gt;Draw();*/</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    output-&gt;Write();</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    output-&gt;Close();</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <span class="keyword">auto</span> endtime = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    <span class="keyword">auto</span> duration = std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(endtime - start);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    cout &lt;&lt; <span class="stringliteral">&quot;Ci sono voluti &quot;</span>&lt;&lt;duration.count() &lt;&lt; <span class="stringliteral">&quot; microsecondi a togliere le sistematiche e ad effettuare il taglio in chi2.&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>}</div>
<div class="ttc" id="aGeneralUtils_8cpp_html_a2d662b9f40450252cd0a030691fc914f"><div class="ttname"><a href="../../dc/d43/GeneralUtils_8cpp.html#a2d662b9f40450252cd0a030691fc914f">LayerCoordinate</a></div><div class="ttdeci">double LayerCoordinate(int &amp;ID)</div><div class="ttdoc">This function corrects shifts along the Z directions given the layer.</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d43/GeneralUtils_8cpp_source.html#l00160">GeneralUtils.cpp:160</a></div></div>
<div class="ttc" id="aGeneralUtils_8h_html"><div class="ttname"><a href="../../dc/d78/GeneralUtils_8h.html">GeneralUtils.h</a></div><div class="ttdoc">Headers for library GeneralUtils.</div></div>
<div class="ttc" id="aUtilsRectifyTracks_8cpp_html_a84e55be38b776611ae78cd78e781086b"><div class="ttname"><a href="../../d4/df5/UtilsRectifyTracks_8cpp.html#a84e55be38b776611ae78cd78e781086b">AngleCorrection</a></div><div class="ttdeci">double AngleCorrection(int &amp;layer, double &amp;mx, double &amp;qx, double &amp;my, double &amp;qy)</div><div class="ttdoc">This function corrects relative rotations for events that have one projection for each vision.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/df5/UtilsRectifyTracks_8cpp_source.html#l00027">UtilsRectifyTracks.cpp:27</a></div></div>
<div class="ttc" id="aUtilsRectifyTracks_8h_html"><div class="ttname"><a href="../../d6/d0d/UtilsRectifyTracks_8h.html">UtilsRectifyTracks.h</a></div><div class="ttdoc">Headers for library UtilsRectifyTracks.</div></div>
<div class="ttc" id="aclassEventoTrack_html"><div class="ttname"><a href="../../d2/da4/classEventoTrack.html">EventoTrack</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc7/EventoTrack_8h_source.html#l00030">EventoTrack.h:31</a></div></div>
<div class="ttc" id="aclassEventoTrack_html_a15a53c929094411a8d5900d51d7eb2ab"><div class="ttname"><a href="../../d2/da4/classEventoTrack.html#a15a53c929094411a8d5900d51d7eb2ab">EventoTrack::TrackX</a></div><div class="ttdeci">std::vector&lt; Track &gt; TrackX</div><div class="ttdoc">Container of the projection on the vision XZ.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dc7/EventoTrack_8h_source.html#l00034">EventoTrack.h:34</a></div></div>
<div class="ttc" id="aclassEventoTrack_html_a5cb6f67c0416adee2f3dee2039944d27"><div class="ttname"><a href="../../d2/da4/classEventoTrack.html#a5cb6f67c0416adee2f3dee2039944d27">EventoTrack::Nx</a></div><div class="ttdeci">int Nx()</div><div class="ttdoc">Method that returns the number of tracks on the vision XZ.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dc7/EventoTrack_8h_source.html#l00039">EventoTrack.h:39</a></div></div>
<div class="ttc" id="aclassEventoTrack_html_a88ac7f432f68018e471bb50b73b36d36"><div class="ttname"><a href="../../d2/da4/classEventoTrack.html#a88ac7f432f68018e471bb50b73b36d36">EventoTrack::Ny</a></div><div class="ttdeci">int Ny()</div><div class="ttdoc">Method that returns the number of tracks on the vision YZ.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dc7/EventoTrack_8h_source.html#l00042">EventoTrack.h:42</a></div></div>
<div class="ttc" id="aclassEventoTrack_html_afc78d0bef2be9a53e9adc51a2a83f9bb"><div class="ttname"><a href="../../d2/da4/classEventoTrack.html#afc78d0bef2be9a53e9adc51a2a83f9bb">EventoTrack::TrackY</a></div><div class="ttdeci">std::vector&lt; Track &gt; TrackY</div><div class="ttdoc">Container of the projection on the vision YZ.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dc7/EventoTrack_8h_source.html#l00036">EventoTrack.h:36</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
